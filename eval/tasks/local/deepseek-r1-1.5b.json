{
  "type": "batch",
  "name": "Kata evaluation suite (deepseek-r1:1.5b)",
  "stopOnError": false,
  "metadata": {
    "suite": "kata_eval_v1",
    "model": "deepseek-r1:1.5b"
  },
  "tasks": [
    {
      "type": "evaluate",
      "name": "Mode 1 Manager (deepseek-r1:1.5b)",
      "prompt": "MODE: 1 Manager (Calibrate and Run the Process)\nROLE: You are the coach/manager for a continuous improvement kata logic machine.\nGOAL: Calibrate the process, compute gaps, and define the next experiments.\n\nCONTEXT: Software delivery kata\nVision: Deliver features 2x faster with <= 2.0% defect escapes.\nConstraints: No team size change. Max 2 experiments per week. Use only the data below.\nCurrent Condition (last 4 sprints):\n- Cycle time (days): [9.5, 8.7, 8.2, 7.9]\n- PR review time (hours): 48\n- WIP limit: 6\n- Actual WIP average: 9\n- Build success rate: 92%\n- Defect escape rate: 3.9%\n- Test coverage: 65%\n- Deployment frequency: 1 per week\nTarget Condition (4 weeks):\n- Cycle time: 6.0 days\n- PR review time: <= 24 hours\n- WIP average: <= 6\n- Defect escape rate: <= 2.5%\n\nTASK:\n1) Compute the baseline average cycle time, the gap to target, and the required percent reduction.\n2) Compute the gaps for PR review time, WIP average, and defect escape rate.\n3) Define up to two experiments that can be run within the constraints.\n4) Provide a short coaching action list for the team.\n5) Include a brief self-check to validate the calculations.\n\nCALCULATION RULES:\n- avg_cycle_time_days = mean of the cycle time list\n- cycle_time_gap_days = avg_cycle_time_days - target cycle time\n- cycle_time_reduction_pct = (cycle_time_gap_days / avg_cycle_time_days) * 100\n- pr_review_gap_hours = current PR review time - target PR review time\n- wip_gap = actual WIP average - target WIP average\n- defect_gap_pct = current defect escape rate - target defect escape rate\n\nOUTPUT RULES:\n- Return a single JSON object only. No extra text, no code fences.\n- Round all numeric values to 2 decimals.\n- Use the exact keys and schema below.\n\nOUTPUT JSON SCHEMA:\n{\n  \"mode\": \"mode1_manager\",\n  \"metrics\": {\n    \"avg_cycle_time_days\": 0,\n    \"cycle_time_gap_days\": 0,\n    \"cycle_time_reduction_pct\": 0,\n    \"pr_review_gap_hours\": 0,\n    \"wip_gap\": 0,\n    \"defect_gap_pct\": 0\n  },\n  \"target_condition\": {\n    \"cycle_time_days\": 6.0,\n    \"pr_review_time_hours\": 24,\n    \"wip_avg\": 6,\n    \"defect_escape_pct\": 2.5\n  },\n  \"experiments\": [\n    {\n      \"id\": \"E1\",\n      \"hypothesis\": \"\",\n      \"step\": \"\",\n      \"expected_metric_change\": \"\",\n      \"timebox_days\": 0\n    }\n  ],\n  \"coach_actions\": [\"\"],\n  \"risks\": [\"\"],\n  \"self_check\": \"\"\n}\n",
      "model": {
        "provider": "ollama",
        "name": "deepseek-r1:1.5b"
      },
      "parameters": {
        "temperature": 0.2,
        "maxTokens": 1600,
        "topP": 0.9
      },
      "options": {
        "outputPath": "results/eval-suite/responses/deepseek-r1-1.5b/mode1_manager.md",
        "includeMetadata": true,
        "timeoutMs": 60000
      },
      "metadata": {
        "mode": "mode1",
        "promptId": "mode1_manager",
        "rubricId": "kata_v1",
        "expected": {
          "metrics": {
            "avg_cycle_time_days": 8.58,
            "cycle_time_gap_days": 2.58,
            "cycle_time_reduction_pct": 30.07,
            "pr_review_gap_hours": 24.0,
            "wip_gap": 3.0,
            "defect_gap_pct": 1.4
          },
          "required_experiments": 1
        },
        "modelDisplayName": "deepseek-r1:1.5b",
        "modelSizeGB": 1.1
      }
    },
    {
      "type": "evaluate",
      "name": "Mode 2 Process Analyst (deepseek-r1:1.5b)",
      "prompt": "MODE: 2 Process Analyst (Quality vs Best Practices + Registries)\nROLE: You evaluate process quality against industry best practices and external registries.\nGOAL: Score compliance, identify gaps, and recommend corrections.\n\nCONTEXT: Software delivery kata\nProcess Evidence:\n- PR template present: yes\n- Required checks on main branch: yes\n- CODEOWNERS file present: no\n- Branch protection (no direct push): yes\n- PR review time (hours): 48\n- Issue triage cadence: ad hoc (not weekly)\n- Cycle time average (days): 8.58\n- Deployment frequency: 1 per week\n- Defect escape rate: 3.9%\n\nRegistry A: GitHub Collaboration Standard v1.2\n- GH-1: PR description template required\n- GH-2: Reviews completed within 24 hours\n- GH-3: Required status checks on protected branches\n- GH-4: CODEOWNERS required for critical paths\n- GH-5: No direct push to protected branches\n- GH-6: Weekly issue triage\n\nRegistry B: DORA Metrics v2 (simplified)\n- DORA-1 Deployment frequency: 1/day high, 1/week medium, 1/month low\n- DORA-2 Lead time: <= 1 day high, <= 7 days medium, > 7 days low\n- DORA-3 Change failure rate: <= 15% high, 16-30% medium, > 30% low\n\nTASK:\n1) Evaluate compliance with Registry A items GH-1..GH-6.\n2) Classify DORA-1, DORA-2, DORA-3 from the evidence.\n3) Provide a process quality rating (high, medium, low) and a numeric compliance score (0-100).\n4) Provide recommendations that cite the registry IDs.\n5) Include a brief self-check.\n\nCLASSIFICATION RULES:\n- DORA-1 uses deployment frequency directly.\n- DORA-2 uses cycle time as the lead time proxy for this task.\n- DORA-3 uses defect escape rate as the change failure rate proxy for this task.\n- Compliance score = (passes / 6) * 100.\n\nOUTPUT RULES:\n- Return a single JSON object only. No extra text, no code fences.\n- Use the exact keys and schema below.\n\nOUTPUT JSON SCHEMA:\n{\n  \"mode\": \"mode2_process_analyst\",\n  \"registry_checks\": [\n    {\"registry_id\": \"GH-1\", \"status\": \"pass\", \"evidence\": \"\", \"recommendation\": \"\"}\n  ],\n  \"dora_classification\": {\n    \"DORA-1\": \"high|medium|low\",\n    \"DORA-2\": \"high|medium|low\",\n    \"DORA-3\": \"high|medium|low\"\n  },\n  \"compliance_score_pct\": 0,\n  \"process_quality_rating\": \"high|medium|low\",\n  \"recommendations\": [\"\"],\n  \"self_check\": \"\"\n}\n",
      "model": {
        "provider": "ollama",
        "name": "deepseek-r1:1.5b"
      },
      "parameters": {
        "temperature": 0.2,
        "maxTokens": 1600,
        "topP": 0.9
      },
      "options": {
        "outputPath": "results/eval-suite/responses/deepseek-r1-1.5b/mode2_process_analyst.md",
        "includeMetadata": true,
        "timeoutMs": 60000
      },
      "metadata": {
        "mode": "mode2",
        "promptId": "mode2_process_analyst",
        "rubricId": "kata_v1",
        "expected": {
          "registry_status": {
            "GH-1": "pass",
            "GH-2": "fail",
            "GH-3": "pass",
            "GH-4": "fail",
            "GH-5": "pass",
            "GH-6": "fail"
          },
          "dora_classification": {
            "DORA-1": "medium",
            "DORA-2": "low",
            "DORA-3": "high"
          },
          "compliance_score_pct": 50,
          "process_quality_rating": "medium"
        },
        "modelDisplayName": "deepseek-r1:1.5b",
        "modelSizeGB": 1.1
      }
    },
    {
      "type": "evaluate",
      "name": "Mode 3 Root Cause (deepseek-r1:1.5b)",
      "prompt": "MODE: 3 Deep Research / Root Cause Analyst\nROLE: You drill into problems using Five Whys and adjacent-context discovery.\nGOAL: Identify root cause(s) and propose better registries to consult.\n\nCONTEXT: Software delivery kata\nProblem signals:\n- Defect escape rate flat at 3.9% for 3 sprints\n- PR review time 48 hours\n- WIP average 9 (limit 6)\n- Test coverage 65%\n- Deployment frequency 1 per week\n\nCandidate registries for adjacent-context discovery:\n- DORA Metrics v2\n- SPACE Framework\n- Accelerate (DevOps Research)\n- OWASP SAMM v2\n- Google SRE Workbook (change management)\n- ISO 9001 (quality systems)\n- GitHub Collaboration Standard v1.2\n\nTASK:\n1) Produce a Five Whys chain of exactly 5 steps.\n2) Identify the most likely root cause.\n3) Select two registries from the list and justify why they should be consulted.\n4) Propose two focused experiments to validate the root cause.\n5) Include a brief self-check.\n\nRULES:\n- The root_cause must be consistent with the 5th why.\n- Choose registries only from the provided list.\n\nOUTPUT RULES:\n- Return a single JSON object only. No extra text, no code fences.\n- Use the exact keys and schema below.\n\nOUTPUT JSON SCHEMA:\n{\n  \"mode\": \"mode3_root_cause\",\n  \"problem_statement\": \"\",\n  \"why_chain\": [\n    {\"why\": 1, \"cause\": \"\"}\n  ],\n  \"root_cause\": \"\",\n  \"adjacent_registry_targets\": [\n    {\"name\": \"\", \"reason\": \"\"}\n  ],\n  \"experiments\": [\n    {\"id\": \"E1\", \"hypothesis\": \"\", \"step\": \"\", \"signal\": \"\"}\n  ],\n  \"self_check\": \"\"\n}\n",
      "model": {
        "provider": "ollama",
        "name": "deepseek-r1:1.5b"
      },
      "parameters": {
        "temperature": 0.2,
        "maxTokens": 1600,
        "topP": 0.9
      },
      "options": {
        "outputPath": "results/eval-suite/responses/deepseek-r1-1.5b/mode3_root_cause.md",
        "includeMetadata": true,
        "timeoutMs": 60000
      },
      "metadata": {
        "mode": "mode3",
        "promptId": "mode3_root_cause",
        "rubricId": "kata_v1",
        "expected": {
          "why_chain_length": 5,
          "adjacent_registry_min": 2
        },
        "modelDisplayName": "deepseek-r1:1.5b",
        "modelSizeGB": 1.1
      }
    },
    {
      "type": "evaluate",
      "name": "Mode 4 Complex Learner (deepseek-r1:1.5b)",
      "prompt": "MODE: 4 Complex Learner (Synthesize Modes 1-3)\nROLE: You synthesize prior modes, update prompts, and adjust process choices.\nGOAL: Produce a coherent update plan based on Mode 3 findings.\n\nINPUTS (from prior modes):\nMode 1 summary:\n- avg_cycle_time_days: 8.58\n- gaps: PR review +24 hours, WIP +3, defect +1.4%\n- experiments: enforce WIP limit; review SLA pilot\n\nMode 2 summary:\n- GH-2 fail (reviews >24h)\n- GH-4 fail (no CODEOWNERS)\n- GH-6 fail (no weekly triage)\n- DORA: Deployment frequency medium, Lead time low (>7 days), Change failure rate high (<=15%)\n\nMode 3 summary:\n- Root cause: review bottleneck + unbounded WIP hides defects\n- Adjacent registries: DORA Metrics v2, SPACE Framework\n- Experiments: add review queue WIP limit; add pre-merge checklist\n\nTASK:\n1) Synthesize the above into a single learning statement.\n2) Update the Mode 1 and Mode 2 prompts with specific improvements based on Mode 3 findings.\n3) Update process choices (experiments or policies) to address root causes.\n4) Define one measurable learning metric for the next iteration.\n5) Include a brief self-check.\n\nRULES:\n- prompt_updates must include entries for mode1_manager and mode2_process_analyst.\n\nOUTPUT RULES:\n- Return a single JSON object only. No extra text, no code fences.\n- Use the exact keys and schema below.\n\nOUTPUT JSON SCHEMA:\n{\n  \"mode\": \"mode4_complex_learner\",\n  \"synthesis\": {\n    \"learning_statement\": \"\",\n    \"top_insights\": [\"\"],\n    \"priority_constraints\": [\"\"],\n    \"risks\": [\"\"]\n  },\n  \"prompt_updates\": [\n    {\"prompt_id\": \"mode1_manager\", \"change\": \"\", \"rationale\": \"\"}\n  ],\n  \"process_updates\": [\n    {\"id\": \"P1\", \"change\": \"\", \"expected_effect\": \"\"}\n  ],\n  \"learning_metric\": {\"name\": \"\", \"definition\": \"\", \"target\": \"\"},\n  \"self_check\": \"\"\n}\n",
      "model": {
        "provider": "ollama",
        "name": "deepseek-r1:1.5b"
      },
      "parameters": {
        "temperature": 0.2,
        "maxTokens": 1600,
        "topP": 0.9
      },
      "options": {
        "outputPath": "results/eval-suite/responses/deepseek-r1-1.5b/mode4_complex_learner.md",
        "includeMetadata": true,
        "timeoutMs": 60000
      },
      "metadata": {
        "mode": "mode4",
        "promptId": "mode4_complex_learner",
        "rubricId": "kata_v1",
        "expected": {
          "required_prompt_updates": [
            "mode1_manager",
            "mode2_process_analyst"
          ],
          "process_updates_min": 1
        },
        "modelDisplayName": "deepseek-r1:1.5b",
        "modelSizeGB": 1.1
      }
    },
    {
      "type": "evaluate",
      "name": "Combined Modes (deepseek-r1:1.5b)",
      "prompt": "MODE: Combined (Modes 1-4 in one run)\nROLE: You are the coach/manager for a continuous improvement kata logic machine.\nGOAL: Produce outputs for Modes 1-4 in a single response.\n\nCONTEXT: Software delivery kata\nVision: Deliver features 2x faster with <= 2.0% defect escapes.\nConstraints: No team size change. Max 2 experiments per week. Use only the data below.\nCurrent Condition (last 4 sprints):\n- Cycle time (days): [9.5, 8.7, 8.2, 7.9]\n- PR review time (hours): 48\n- WIP limit: 6\n- Actual WIP average: 9\n- Build success rate: 92%\n- Defect escape rate: 3.9%\n- Test coverage: 65%\n- Deployment frequency: 1 per week\nTarget Condition (4 weeks):\n- Cycle time: 6.0 days\n- PR review time: <= 24 hours\n- WIP average: <= 6\n- Defect escape rate: <= 2.5%\n\nRegistry A: GitHub Collaboration Standard v1.2\n- GH-1: PR description template required\n- GH-2: Reviews completed within 24 hours\n- GH-3: Required status checks on protected branches\n- GH-4: CODEOWNERS required for critical paths\n- GH-5: No direct push to protected branches\n- GH-6: Weekly issue triage\n\nRegistry B: DORA Metrics v2 (simplified)\n- DORA-1 Deployment frequency: 1/day high, 1/week medium, 1/month low\n- DORA-2 Lead time: <= 1 day high, <= 7 days medium, > 7 days low\n- DORA-3 Change failure rate: <= 15% high, 16-30% medium, > 30% low\n\nCandidate registries for adjacent-context discovery:\n- DORA Metrics v2\n- SPACE Framework\n- Accelerate (DevOps Research)\n- OWASP SAMM v2\n- Google SRE Workbook (change management)\n- ISO 9001 (quality systems)\n- GitHub Collaboration Standard v1.2\n\nTASK:\n1) Mode 1: compute gaps and propose up to two experiments.\n2) Mode 2: evaluate registries and classify DORA metrics.\n3) Mode 3: five whys (5 steps) and pick two registries.\n4) Mode 4: synthesize and update prompts/process.\n5) Include a brief self-check at the top level.\n\nCALCULATION + CLASSIFICATION RULES:\n- avg_cycle_time_days = mean of the cycle time list.\n- cycle_time_gap_days = avg_cycle_time_days - target cycle time.\n- cycle_time_reduction_pct = (cycle_time_gap_days / avg_cycle_time_days) * 100.\n- pr_review_gap_hours = current PR review time - target PR review time.\n- wip_gap = actual WIP average - target WIP average.\n- defect_gap_pct = current defect escape rate - target defect escape rate.\n- DORA-2 uses cycle time as the lead time proxy for this task.\n- DORA-3 uses defect escape rate as the change failure rate proxy for this task.\n- Compliance score = (passes / 6) * 100.\n\nOUTPUT RULES:\n- Return a single JSON object only. No extra text, no code fences.\n- Round all numeric values to 2 decimals.\n- Use the exact keys and schema below.\n\nOUTPUT JSON SCHEMA:\n{\n  \"mode\": \"combined\",\n  \"mode1\": {\"metrics\": {}, \"experiments\": [], \"coach_actions\": [], \"risks\": []},\n  \"mode2\": {\"registry_checks\": [], \"dora_classification\": {}, \"compliance_score_pct\": 0, \"process_quality_rating\": \"\"},\n  \"mode3\": {\"why_chain\": [], \"root_cause\": \"\", \"adjacent_registry_targets\": [], \"experiments\": []},\n  \"mode4\": {\"synthesis\": {}, \"prompt_updates\": [], \"process_updates\": [], \"learning_metric\": {}},\n  \"self_check\": \"\"\n}\n",
      "model": {
        "provider": "ollama",
        "name": "deepseek-r1:1.5b"
      },
      "parameters": {
        "temperature": 0.2,
        "maxTokens": 1600,
        "topP": 0.9
      },
      "options": {
        "outputPath": "results/eval-suite/responses/deepseek-r1-1.5b/mode_combined.md",
        "includeMetadata": true,
        "timeoutMs": 60000
      },
      "metadata": {
        "mode": "combined",
        "promptId": "mode_combined",
        "rubricId": "kata_v1",
        "expected": {
          "mode1_metrics": {
            "avg_cycle_time_days": 8.58,
            "cycle_time_gap_days": 2.58,
            "cycle_time_reduction_pct": 30.07,
            "pr_review_gap_hours": 24.0,
            "wip_gap": 3.0,
            "defect_gap_pct": 1.4
          },
          "mode2_registry_status": {
            "GH-1": "pass",
            "GH-2": "fail",
            "GH-3": "pass",
            "GH-4": "fail",
            "GH-5": "pass",
            "GH-6": "fail"
          }
        },
        "modelDisplayName": "deepseek-r1:1.5b",
        "modelSizeGB": 1.1
      }
    }
  ]
}
