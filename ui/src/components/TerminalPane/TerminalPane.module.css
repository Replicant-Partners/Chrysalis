/**
 * TerminalPane Styles
 * 
 * Styles for the terminal emulation component using xterm.js
 * Follows the Chrysalis design system tokens
 */

/* ============================================================================
   Container Styles
   ============================================================================ */

.terminalPane {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background: var(--color-surface-primary, #1e1e2e);
  border-radius: var(--radius-lg, 12px);
  overflow: hidden;
  box-shadow: var(--shadow-md, 0 4px 12px rgba(0, 0, 0, 0.15));
  border: 1px solid var(--color-border-subtle, rgba(255, 255, 255, 0.08));
}

.terminalContainer {
  flex: 1;
  min-height: 0;
  padding: var(--space-2, 8px);
  overflow: hidden;
}

/* Read-only state - disable cursor and input */
.terminalContainer[data-read-only="true"] {
  pointer-events: none;
  user-select: text;
}

.terminalContainer[data-read-only="true"] :global(.xterm-cursor-layer) {
  display: none;
}

/* ============================================================================
   Header Styles
   ============================================================================ */

.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-2, 8px) var(--space-3, 12px);
  background: var(--color-surface-secondary, rgba(255, 255, 255, 0.03));
  border-bottom: 1px solid var(--color-border-subtle, rgba(255, 255, 255, 0.08));
  min-height: 44px;
}

.headerLeft {
  display: flex;
  align-items: center;
  gap: var(--space-2, 8px);
}

.headerRight {
  display: flex;
  align-items: center;
  gap: var(--space-3, 12px);
}

.headerIcon {
  font-size: 1rem;
  opacity: 0.7;
}

.headerTitle {
  margin: 0;
  font-size: var(--font-size-sm, 0.875rem);
  font-weight: var(--font-weight-medium, 500);
  color: var(--color-text-primary, #cdd6f4);
}

.headerButtons {
  display: flex;
  gap: var(--space-1, 4px);
}

.backendBadge {
  font-size: var(--font-size-xs, 0.75rem);
  padding: var(--space-0-5, 2px) var(--space-1, 4px);
}

/* ============================================================================
   Error Container
   ============================================================================ */

.errorContainer {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
  background: var(--color-surface-primary, #1e1e2e);
  padding: var(--space-6, 24px);
}

.errorContent {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-3, 12px);
  text-align: center;
  max-width: 400px;
}

.errorIcon {
  font-size: 3rem;
  opacity: 0.8;
}

.errorContent h4 {
  margin: 0;
  font-size: var(--font-size-lg, 1.125rem);
  font-weight: var(--font-weight-semibold, 600);
  color: var(--color-text-primary, #cdd6f4);
}

.errorContent p {
  margin: 0;
  font-size: var(--font-size-sm, 0.875rem);
  color: var(--color-text-secondary, #a6adc8);
}

/* ============================================================================
   Context Lost Warning
   ============================================================================ */

.contextLostWarning {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-1, 4px) var(--space-2, 8px);
  background: var(--color-warning-bg, rgba(249, 226, 175, 0.1));
  color: var(--color-warning, #f9e2af);
  font-size: var(--font-size-xs, 0.75rem);
  border-bottom: 1px solid var(--color-warning, rgba(249, 226, 175, 0.2));
}

.contextLostWarning span {
  display: flex;
  align-items: center;
  gap: var(--space-1, 4px);
}

/* ============================================================================
   xterm.js Overrides
   ============================================================================ */

/* Ensure terminal fills container */
.terminalContainer :global(.xterm) {
  height: 100%;
  width: 100%;
  padding: 0;
}

.terminalContainer :global(.xterm-viewport) {
  /* Custom scrollbar styling */
  scrollbar-width: thin;
  scrollbar-color: var(--color-scrollbar-thumb, rgba(255, 255, 255, 0.2)) transparent;
}

.terminalContainer :global(.xterm-viewport::-webkit-scrollbar) {
  width: 8px;
}

.terminalContainer :global(.xterm-viewport::-webkit-scrollbar-track) {
  background: transparent;
}

.terminalContainer :global(.xterm-viewport::-webkit-scrollbar-thumb) {
  background: var(--color-scrollbar-thumb, rgba(255, 255, 255, 0.2));
  border-radius: 4px;
}

.terminalContainer :global(.xterm-viewport::-webkit-scrollbar-thumb:hover) {
  background: var(--color-scrollbar-thumb-hover, rgba(255, 255, 255, 0.3));
}

/* Selection styling */
.terminalContainer :global(.xterm-selection div) {
  background: var(--color-selection, rgba(88, 91, 112, 0.5)) !important;
}

/* Cursor animation */
.terminalContainer :global(.xterm-cursor-block) {
  background: var(--color-cursor, #f5e0dc) !important;
}

.terminalContainer :global(.xterm-cursor-outline) {
  outline-color: var(--color-cursor, #f5e0dc) !important;
}

.terminalContainer :global(.xterm-cursor-bar) {
  background: var(--color-cursor, #f5e0dc) !important;
}

.terminalContainer :global(.xterm-cursor-underline) {
  border-bottom-color: var(--color-cursor, #f5e0dc) !important;
}

/* Focus indicator */
.terminalPane:focus-within {
  outline: 2px solid var(--color-focus, rgba(137, 180, 250, 0.5));
  outline-offset: -2px;
}

/* ============================================================================
   Responsive Styles
   ============================================================================ */

@media (max-width: 768px) {
  .header {
    flex-wrap: wrap;
    gap: var(--space-2, 8px);
  }
  
  .headerRight {
    width: 100%;
    justify-content: space-between;
  }
  
  .terminalContainer {
    padding: var(--space-1, 4px);
  }
}

/* ============================================================================
   Animation States
   ============================================================================ */

/* Connecting animation */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.header [data-connecting="true"] {
  animation: pulse 1.5s ease-in-out infinite;
}

/* WebGL badge glow */
.backendBadge[data-backend="webgl"] {
  box-shadow: 0 0 8px var(--color-success-glow, rgba(166, 227, 161, 0.3));
}

/* ============================================================================
   Accessibility
   ============================================================================ */

/* High contrast mode support */
@media (prefers-contrast: high) {
  .terminalPane {
    border-width: 2px;
  }
  
  .header {
    border-bottom-width: 2px;
  }
  
  .terminalContainer :global(.xterm-selection div) {
    background: HighlightText !important;
    color: Highlight !important;
  }
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .header [data-connecting="true"] {
    animation: none;
  }
  
  .terminalContainer :global(.xterm-cursor) {
    animation: none !important;
  }
}

/* Screen reader only content */
.srOnly {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
